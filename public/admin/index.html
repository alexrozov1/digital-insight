<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Digital Insight â€” Admin</title>
  </head>
  <body>
    <!-- Mount point Decap expects -->
    <div id="nc-root"></div>

    <!-- Optional debug: start OAuth if needed -->
    <a href="/api/auth" style="position:fixed;top:10px;right:10px;padding:6px 10px;border:1px solid #ccc;border-radius:8px;font:12px system-ui;text-decoration:none;color:#333">Debug: Start GitHub Login</a>

    <!-- Manual init so we control config path -->
    <script>window.CMS_MANUAL_INIT = true;</script>
    <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
    <script>
      // Point CMS to your YAML config (now served at /admin/config.yml)
      window.CMS.init({ configPath: "/admin/config.yml" });
    </script>
  </body>
</html>
<script>
  window.addEventListener('message', (e) => {
    if (typeof e.data === 'string' && e.data.startsWith('authorization:github:')) {
      console.log('Admin received auth message:', e.data.slice(22));
    }
  });
</script>
